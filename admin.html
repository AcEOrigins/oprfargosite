<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - OPR Fargo</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="assets/opr1.jpg">
    <link rel="apple-touch-icon" href="assets/opr1.jpg">
    
    <link rel="stylesheet" href="css/admin-fallback.css">
</head>
<body>
    <!-- Password Protection Modal -->
    <div class="password-modal" id="passwordModal">
        <div class="password-modal-content">
            <div class="password-modal-logo">
                <img src="assets/opr1.jpg" alt="OPR Fargo">
            </div>
            <h2>Admin Access</h2>
            <p>Please enter the admin password to continue</p>
            <div class="form-group">
                <input type="password" id="passwordInput" placeholder="Enter password" autocomplete="off">
                <p class="error-message" id="passwordError" style="display: none; color: var(--error); margin-top: 0.5rem; font-size: 0.9rem;"></p>
            </div>
            <button class="add-server-btn" onclick="checkPassword()">Enter</button>
        </div>
    </div>

    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen" style="display: none;">
        <div class="loading-logo-container">
            <div class="loading-logo" id="loadingLogo">
                <img src="assets/opr1.jpg" alt="OPR Fargo">
            </div>
            <svg class="trace-svg" viewBox="0 0 200 200">
                <!-- Yellow trace (Ukrainian flag yellow) -->
                <circle class="trace-line trace-yellow" cx="100" cy="100" r="70" fill="none" stroke="#FFD700" stroke-width="4" stroke-linecap="round"/>
                <!-- Blue trace (Ukrainian flag blue) -->
                <circle class="trace-line trace-blue" cx="100" cy="100" r="70" fill="none" stroke="#0057B8" stroke-width="4" stroke-linecap="round"/>
                <!-- White trace (Russian flag white) -->
                <circle class="trace-line trace-white" cx="100" cy="100" r="70" fill="none" stroke="#FFFFFF" stroke-width="4" stroke-linecap="round"/>
                <!-- Blue trace 2 (Russian flag blue) -->
                <circle class="trace-line trace-blue2" cx="100" cy="100" r="70" fill="none" stroke="#0039A6" stroke-width="4" stroke-linecap="round"/>
                <!-- Red trace (Russian flag red) -->
                <circle class="trace-line trace-red" cx="100" cy="100" r="70" fill="none" stroke="#D52B1E" stroke-width="4" stroke-linecap="round"/>
            </svg>
        </div>
    </div>

    <div id="adminContent" style="display: none;">
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-brand">
                    <a href="index.html" style="text-decoration: none;">
                        <h1>OPR Fargo</h1>
                    </a>
                </div>
                <div class="nav-links">
                    <a href="index.html" class="admin-toggle">Back to Website</a>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>
        </nav>

        <div class="section-header-bar" id="mainHeaderBar">
            <h2 id="headerBarTitle">Server Management</h2>
        </div>

        <div class="admin-layout">
            <!-- Sidebar Navigation -->
            <aside class="admin-sidebar">
                <div class="sidebar-content">
                    <div class="sidebar-item active" data-section="servers">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <span>Servers</span>
                    </div>
                    <div class="sidebar-item" data-section="slideshow">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                        </svg>
                        <span>Slideshow</span>
                    </div>
                    <div class="sidebar-item" data-section="events">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zm0-12H5V6h14v2z"/>
                        </svg>
                        <span>Events</span>
                    </div>
                    <div class="sidebar-item" data-section="settings">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                        </svg>
                        <span>Settings</span>
                    </div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="admin-main">
                <div class="admin-section" id="servers-display-section" style="display: block;">
                    <div class="servers-grid" id="adminServersList">
                        <div class="loading">Loading servers...</div>
                    </div>
                </div>

                <!-- Add Server Modal -->
                <div class="add-server-modal" id="addServerModal" style="display: none;">
                    <div class="add-server-modal-content">
                        <button class="modal-close-btn" onclick="closeAddServerModal()" aria-label="Close">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                            </svg>
                        </button>
                        <h2>Add New Server</h2>
                        <div class="form-group">
                            <label for="serverName">Server Display Name</label>
                            <input type="text" id="serverName" placeholder="e.g., OPR Fargo Main Server">
                        </div>
                        <div class="form-group">
                            <label for="battlemetricsId">BattleMetrics Server ID</label>
                            <input type="text" id="battlemetricsId" placeholder="e.g., 12345678">
                        </div>
                        <button class="add-server-btn" onclick="addServer()">Add Server</button>
                    </div>
                </div>

                <!-- Floating Add Button (only visible on servers tab) -->
                <button class="floating-add-btn" id="floatingAddBtn" onclick="openAddServerModal()" aria-label="Add server" style="display: none;">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                </button>

                <!-- Toast Container -->
                <div class="toast-container" id="toastContainer"></div>

                <div class="admin-section" id="slideshow-section" style="display: none;">
                    <div class="images-grid-container">
                        <div class="images-grid" id="imagesGrid">
                            <div class="loading">Loading images...</div>
                        </div>
                    </div>
                    
                    <!-- Hidden file input -->
                    <input type="file" id="imageUploadInput" accept="image/*" style="display: none;" multiple>
                    <!-- Floating Add Image Button (only visible on slideshow tab) -->
                    <button class="floating-add-image-btn" id="floatingAddImageBtn" onclick="openImageUploadModal()" aria-label="Add image" style="display: none;">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                    </button>
                </div>
                
                <!-- Add Image Upload Modal -->
                <div class="upload-image-modal" id="uploadImageModal" style="display: none;">
                    <div class="upload-image-modal-overlay"></div>
                    <div class="upload-image-modal-content">
                        <div class="upload-image-modal-header">
                            <h2>Add Images</h2>
                            <button class="modal-close-btn" onclick="closeImageUploadModal()" aria-label="Close">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                </svg>
                            </button>
                        </div>
                        <div class="upload-image-modal-body">
                            <div class="upload-drop-zone" id="uploadDropZone" onclick="triggerFileInput()">
                                <div class="upload-drop-zone-content">
                                    <svg viewBox="0 0 24 24" fill="currentColor" style="width: 64px; height: 64px; margin-bottom: 1rem;">
                                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                                    </svg>
                                    <p class="upload-drop-text">Drag and drop images here</p>
                                    <p class="upload-drop-text-secondary">or click to browse</p>
                                </div>
                            </div>
                            <p class="upload-info-text">Supported formats: JPG, PNG, GIF, WebP</p>
                        </div>
                    </div>
                </div>
                
                <!-- Context Menu -->
                <div class="context-menu" id="contextMenu" style="display: none;">
                    <div class="context-menu-item" onclick="openSetImageModal()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                        </svg>
                        <span>Set Image</span>
                    </div>
                    <div class="context-menu-item" onclick="renameImage()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                        </svg>
                        <span>Rename</span>
                    </div>
                    <div class="context-menu-divider"></div>
                    <div class="context-menu-item context-menu-item-danger" onclick="deleteImage()">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                        </svg>
                        <span>Delete</span>
                    </div>
                </div>
                
                <!-- Set Image Modal -->
                <div class="set-image-modal" id="setImageModal" style="display: none;">
                    <div class="set-image-modal-overlay"></div>
                    <div class="set-image-modal-content">
                        <div class="set-image-modal-header">
                            <h2>Set Slideshow Image</h2>
                            <button class="modal-close-btn" onclick="closeSetImageModal()" aria-label="Close">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                </svg>
                            </button>
                        </div>
                        <div class="set-image-modal-body">
                            <p>Select which slideshow position to use this image:</p>
                            <div class="slideshow-positions" id="slideshowPositions">
                                <!-- Dynamically loaded slides -->
                            </div>
                            <button class="add-slide-btn" onclick="addNewSlide()" style="margin-top: 1rem;">
                                <svg viewBox="0 0 24 24" fill="currentColor" style="width: 20px; height: 20px; margin-right: 0.5rem;">
                                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                                </svg>
                                Add Slide
                            </button>
                            <p class="info-text">This will replace the current image at the selected position.</p>
                        </div>
                        <div class="set-image-modal-footer">
                            <button class="delete-btn-cancel" onclick="closeSetImageModal()">Cancel</button>
                            <button class="delete-btn-confirm" onclick="confirmSetImage()">Set Image</button>
                        </div>
                    </div>
                </div>
                
                <!-- Rename Image Modal -->
                <div class="rename-image-modal" id="renameImageModal" style="display: none;">
                    <div class="rename-image-modal-overlay"></div>
                    <div class="rename-image-modal-content">
                        <div class="rename-image-modal-header">
                            <h2>Rename Image</h2>
                            <button class="modal-close-btn" onclick="closeRenameModal()" aria-label="Close">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                </svg>
                            </button>
                        </div>
                        <div class="rename-image-modal-body">
                            <div class="form-group">
                                <label for="newImageName">Image Name</label>
                                <input type="text" id="newImageName" placeholder="Enter image name">
                            </div>
                        </div>
                        <div class="rename-image-modal-footer">
                            <button class="delete-btn-cancel" onclick="closeRenameModal()">Cancel</button>
                            <button class="delete-btn-confirm" onclick="confirmRenameImage()">Rename</button>
                        </div>
                    </div>
                </div>

                <div class="admin-section" id="events-section" style="display: none;">
                    <div class="servers-grid" id="adminEventsList">
                        <div class="loading">Loading events...</div>
                    </div>
                </div>

                <!-- Add Event Modal -->
                <div class="add-server-modal" id="addEventModal" style="display: none;">
                    <div class="add-server-modal-content">
                        <button class="modal-close-btn" onclick="closeAddEventModal()" aria-label="Close">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                            </svg>
                        </button>
                        <h2>Add New Event</h2>
                        <div class="form-group">
                            <label for="eventTitle">Event Title</label>
                            <input type="text" id="eventTitle" placeholder="e.g., Weekly Tournament">
                        </div>
                        <div class="form-group">
                            <label for="eventDate">Event Date & Time</label>
                            <input type="datetime-local" id="eventDate">
                        </div>
                        <div class="form-group">
                            <label for="eventDescription">Event Description</label>
                            <textarea id="eventDescription" rows="3" placeholder="Describe the event..."></textarea>
                        </div>
                        <button class="add-server-btn" onclick="addEvent()">Add Event</button>
                    </div>
                </div>

                <!-- Floating Add Event Button (only visible on events tab) -->
                <button class="floating-add-btn" id="floatingAddEventBtn" onclick="openAddEventModal()" aria-label="Add event" style="display: none;">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                </button>

                <div class="admin-section" id="settings-section" style="display: none;">
                    <div class="admin-form">
                        <div class="form-group">
                            <label for="updateInterval">Server Update Interval (seconds)</label>
                            <input type="number" id="updateInterval" placeholder="30" min="10" max="300">
                        </div>
                        <button class="add-server-btn" onclick="saveSettings()">Save Settings</button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Delete Server Confirmation Modal -->
    <div class="delete-modal" id="deleteModal" style="display: none;">
        <div class="delete-modal-overlay"></div>
        <div class="delete-modal-content">
            <div class="delete-modal-header">
                <h2>Remove Server</h2>
            </div>
            <div class="delete-modal-body">
                <p>Are you sure you want to remove <strong id="deleteServerName"></strong>?</p>
                <p class="delete-warning">This action cannot be undone.</p>
            </div>
            <div class="delete-modal-footer">
                <button class="delete-btn-cancel" onclick="closeDeleteModal()">Cancel</button>
                <button class="delete-btn-confirm" onclick="confirmDelete()">Remove</button>
            </div>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/newadmin.js"></script>
    <script src="js/slideshow-admin.js"></script>
</body>
</html>

